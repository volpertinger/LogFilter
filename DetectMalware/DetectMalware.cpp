#include <iostream>
#include <string>
#include <nlohmann/json.hpp>

using json = nlohmann::json;


class OperationData {
public:
	std::string detail;
	std::string operation;
	std::string pid;
	std::string path;
	std::string processIndex;
	std::string processName;
	std::string result;
	std::string timeOfDay;

	bool isMalicious() {
		if (result == "SUCCESS")
			return true;
		return false;
	}
};


int main(int argc, char* argv[]) {

	if (argc != 2) {
		std::cerr << "Usage: " << argv[0] << " <input json event array>" << std::endl;
		return 1;
	}

	std::string jsonInput = argv[1];

	auto jsonData = json::parse(jsonInput);

	OperationData operationData = {
		jsonData["Detail"],
		jsonData["Operation"],
		jsonData["PID"],
		jsonData["Path"],
		jsonData["ProcessIndex"],
		jsonData["Process_Name"],
		jsonData["Result"],
		jsonData["Time_of_Day"]
	};

	if (operationData.isMalicious())
		std::cout << operationData.pid;

	return 0;
}
